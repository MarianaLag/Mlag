{
    "contents" : "#' Estimate genetic diversity among strata in a Population,\n#' \n#' This function is the main one used for estimating genetic diversity among \n#'  stratua.  Given the large number of genetic diversity metrics, not all \n#'  potential types are included.  \n#' @param x A \\code{data.frame} object with \\code{\\link{locus}} columns.\n#' @param stratum The strata by which the genetic distances are estimated.  This\n#'    can be an optional parameter when estimating distance measures calculated\n#'    among indiviudals (default='Population'). \n#' @param mode The particular genetic diversity metric that you are going to use. \n#'    The \\code{gstudio} package currently includes the following individual distance \n#'    measures:\n#'    \\itemize{\n#'      \\item{A}{Number of alleles}\n#'      \\item{Ae}{Effective number of alleles (default)}\n#'      \\item{A95}{Number of alleles with frequency at least five percent}\n#'      \\item{He}{Expected heterozygosity}\n#'      \\item{Ho}{Observed heterozygosity}\n#'      \\item{Fis}{Wright's Inbreeding coefficient (size corrected).}\n#'    }\n#' @return A \\code{data.frame} with columns for strata, diversity (mode), and potentially P(mode=0).\n#' @export\n#' @author Rodney J. Dyer \\email{rjdyer@@vcu.edu}\n#' @examples\n#'  AA <- locus( c(\"A\",\"A\") )\n#'  AB <- locus( c(\"A\",\"B\") )\n#'  BB <- locus( c(\"B\",\"B\") )\n#'  locus <- c(AA,AA,AA,AA,BB,BB,BB,AB,AB,AA)\n#'  locus2 <- c(AB,BB,AA,BB,BB,AB,AB,AA,AA,BB)\n#'  Population <- c(rep(\"Pop-A\",5),rep(\"Pop-B\",5))\n#'  df <- data.frame( Population, TPI=locus, PGM=locus2 )\n#'  genetic_diversity( df, mode=\"Ae\")\ngenetic_diversity <- function( x, stratum=NULL, mode=c(\"A\",\"Ae\",\"A95\",\"He\", \"Ho\", \"Fis\")[2] ){\n  \n  if( missing(x) )\n    stop(\"You must pass a data.frame to the genetic_diversity() function.\")\n  \n  if( !is.null(stratum)) {\n    pops <- partition(x,stratum)\n    ret <- data.frame(Stratum=NA,Locus=NA, Diversity=NA)\n    for( pop in names(pops) ){\n      gd <- genetic_diversity(pops[[pop]], mode=mode )\n      gd$Stratum <- pop\n      gd <- gd[, c(3,1,2)]\n      names(ret)[3] <- mode\n      ret <- rbind( ret, gd )\n    }\n    \n    ret <- ret[ !is.na(ret$Stratum),]\n    return( ret )\n  }\n\n    \n  \n  mode <- tolower( mode )\n  \n  if( mode == \"a\")\n    ret <- A(x)\n  else if( mode == \"ae\")\n    ret <- Ae(x)\n  else if( mode == \"a95\")\n    ret <- A(x,min_freq=0.05)\n  else if( mode == \"he\")\n    ret <- He(x)\n  else if( mode == \"ho\")\n    ret <- Ho(x)\n  else if( mode == \"fis\")\n    ret <- Fis(x)\n  else\n    stop(paste(\"The type of diversity measure '\", mode, \"' you requested was not recognized.\", sep=\"\"))\n  \n  \n  \n    \n  \n  return( ret )\n}\n",
    "created" : 1378254429328.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2235257027",
    "id" : "A18F04",
    "lastKnownWriteTime" : 1373216584,
    "path" : "~/Dropbox/R/gstudio/gstudio/R/genetic_diversity.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}